let user;axios.get("api/me").then(e=>{user=e.data.data,console.log(user);var t=document.createElement("div"),s=document.createElement("div"),a=document.createElement("div"),n=document.querySelector(".kullaniciKarti");t.classList.add("fotoKart"),t.classList.add("col-4"),t.classList.add("py-2"),s.classList.add("pt-2"),a.classList.add("mt-2"),a.classList.add("row"),a.classList.add("box"),a.classList.add("mx-2"),a.classList.add("bg-grey");e=document.createElement("img");e.classList.add("foto"),t.appendChild(e),e.src=user.profile.picture,s.classList.add("col-8"),s.classList.add("my-auto");e=document.createElement("p");e.classList.add("isimler"),s.appendChild(e),e.innerHTML=user.profile.name,a.appendChild(t),a.appendChild(s),n.appendChild(a)}).catch(e=>alert("Error: Cannot access your profile. Please refresh or resign."));const socket=io("/gaming"),sendMessageBtn=document.getElementById("send-message-btn"),messageText=document.getElementById("message-text"),chatCard=document.querySelector(".chatKarti"),div=document.getElementById("chatKarti");$("#message-text").keypress(function(e){"13"==(e.keyCode||e.which)&&sendMessage()}),sendMessageBtn.addEventListener("click",function(){sendMessage()});const sendMessage=()=>{if(messageText.value){var t=document.createElement("div"),s=document.createElement("span"),a=document.createElement("span"),n=document.createElement("span"),d=document.createElement("img");chatCard.appendChild(t),t.classList.add("konteyner"),a.style.color="#620075",a.style.fontWeight="bold",t.appendChild(n),t.classList.add("darker"),t.appendChild(d),t.appendChild(a),t.appendChild(s),d.classList.add("right"),d.style.border="3px solid "+user.profile.color,n.classList.add("time-left"),s.innerHTML=messageText.value,a.style.marginRight="5px",a.innerHTML=user.profile.name;const l=new Date;let e;1==l.getHours().toString().length||1==l.getMinutes().toString().length?1==l.getHours().toString().length&&2==l.getMinutes().toString().length?e="0"+l.getHours()+":"+l.getMinutes():2==l.getHours().toString().length&&1==l.getMinutes().toString().length?e=l.getHours()+":0"+l.getMinutes():1==l.getHours().toString().length&&1==l.getMinutes().toString().length&&(e="0"+l.getHours()+":0"+l.getMinutes()):e=l.getHours()+":"+l.getMinutes(),n.innerHTML=e,d.src=user.profile.picture,messageText.value&&socket.emit("gaming",messageText.value),messageText.value="",$("#chatKarti").animate({scrollTop:div.scrollHeight-div.clientHeight},{easing:"swing",duration:100})}},takeMessage=e=>{var t=document.createElement("div"),s=document.createElement("span"),a=document.createElement("span"),n=document.createElement("span"),d=document.createElement("img");chatCard.appendChild(t),t.classList.add("konteyner"),a.style.color=e.user.color,a.style.fontWeight="bold",n.classList.add("time-right"),s.innerHTML=e.msg,a.style.marginRight="5px",a.innerHTML=e.user.name,n.innerHTML=e.time,d.src=e.user.picture,t.appendChild(d),t.appendChild(n),t.appendChild(a),t.appendChild(s),$("#chatKarti").animate({scrollTop:div.scrollHeight-div.clientHeight},{easing:"swing",duration:100})},createUsers=e=>{for(var t=0;t<e.length;t++){var s=document.createElement("div"),a=document.createElement("div"),n=document.createElement("div"),d=document.querySelector(".kullaniciKarti");s.classList.add("fotoKart"),s.classList.add("col-4"),s.classList.add("py-2"),a.classList.add("pt-2"),n.classList.add("mt-2"),n.classList.add("row"),n.classList.add("box"),n.classList.add("mx-2"),n.classList.add("bg-grey");var l=document.createElement("img");l.classList.add("foto"),s.appendChild(l),l.src=e[t].user[0].profile.picture,a.classList.add("col-8"),a.classList.add("my-auto");l=document.createElement("p");l.classList.add("isimler"),a.appendChild(l),l.innerHTML=e[t].user[0].profile.name,n.appendChild(s),n.appendChild(a),d.appendChild(n)}},createUser=e=>{let t=0;for(var s,a,n,d,l,i=document.getElementsByClassName("username"),c=0;c<i.length;c++)i[c].innerHTML==e.name&&(t=1);0==t&&(s=document.createElement("div"),a=document.createElement("div"),n=document.createElement("div"),d=document.querySelector(".kullaniciKarti"),s.classList.add("fotoKart"),s.classList.add("col-4"),s.classList.add("py-2"),a.classList.add("pt-2"),n.classList.add("mt-2"),n.classList.add("row"),n.classList.add("box"),n.classList.add("mx-2"),n.classList.add("bg-grey"),(l=document.createElement("img")).classList.add("foto"),s.appendChild(l),l.src=e.picture,a.classList.add("col-8"),a.classList.add("my-auto"),(l=document.createElement("p")).classList.add("isimler"),a.appendChild(l),l.innerHTML=e.name,n.appendChild(s),n.appendChild(a),d.appendChild(n))},deleteUser=e=>{var t=document.getElementsByClassName("isimler");console.log(t);for(var s,a=document.querySelector(".kullaniciKarti"),n=0;n<t.length;n++)t[n].innerHTML==e.name&&(s=t[n].parentElement.parentElement,a.removeChild(s))};socket.on("gaming",e=>{console.log(e),takeMessage(e)}),socket.on("gaming-users-connect",e=>{console.log("success enter"),console.log(e),createUsers(e)}),socket.on("gaming-user-connect",e=>{console.log("user connected"),console.log(e),createUser(e)}),socket.on("gaming-user-disconnect",e=>{console.log("user disconnected"),console.log(e),deleteUser(e)});